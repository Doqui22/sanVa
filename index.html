<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Una sorpresa para ti</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        :root { --heart-color: #d32f2f; --letter: #fdf5e6; }
        body { margin:0; padding:0; background: radial-gradient(circle at center, #ffdde1, #ee9ca7); font-family:'Quicksand',sans-serif; height:100vh; overflow:hidden; }

        #initial-screen { position:fixed; inset:0; display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:100; transition:opacity 0.8s, visibility 0.8s; }
        #heart-button { width:180px; cursor:pointer; animation:pulse-heart 1.5s infinite; }
        #heart-button:hover { transform: scale(1.1); }
        .click-instruction { margin-top:20px; color:#d32f2f; font-weight:600; }

        @keyframes pulse-heart { 0%,100%{transform:scale(1)} 50%{transform:scale(1.08)} }

        #main-content-container { position:fixed; inset:0; display:flex; justify-content:center; align-items:center; z-index:50; opacity:0; visibility:hidden; transition:opacity 1s ease-in 0.5s; }
        .San_Valentin { width:90%; max-width:620px; background:#fdf5e6; border-radius:20px; box-shadow:0 15px 35px rgba(0,0,0,0.25); padding:35px; display:flex; flex-direction:column; transform:translateY(30px); transition:transform 1s; }

        .content-wrapper { display:flex; justify-content:space-between; }
        .text-section { width:52%; line-height:1.7; color:#4a4a4a; }
        .title { font-weight:700; color:var(--heart-color); margin-bottom:15px; }
        .signature { margin-top:20px; font-style:italic; color:#555; }

        .image-section { width:45%; height:280px; display:flex; justify-content:center; align-items:center; }
        #heart-tree-canvas { width:100%; height:100%; max-width:300px; }

        .timer-section { margin-top:25px; border-top:2px solid rgba(0,0,0,0.05); padding-top:15px; }
        .timer-title { font-size:1rem; color:#666; }
        .timer-display { display:flex; flex-wrap:wrap; gap:12px; font-size:1.45rem; color:#333; }
        .time-unit { font-weight:700; color:var(--heart-color); }

        .buttons { margin-top:25px; display:flex; gap:15px; justify-content:center; flex-wrap:wrap; }
        button {
            padding: 14px 35px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }
        button:hover { transform: scale(1.05); }
        #download-pdf { background:#d32f2f; color:white; }
        #share-html { background:#4caf50; color:white; }

        @media (max-width:480px) {
            .content-wrapper { flex-direction:column; }
            .text-section, .image-section { width:100%; }
            .image-section { height:220px; margin:20px 0; }
        }

        body.open-letter #initial-screen { opacity:0; visibility:hidden; }
        body.open-letter #main-content-container { opacity:1; visibility:visible; }
        body.open-letter .San_Valentin { transform:translateY(0); }
    </style>
</head>
<body>

    <div id="initial-screen">
        <img src="https://cdn-icons-png.flaticon.com/512/210/210545.png" alt="Abrir carta" id="heart-button">
        <p class="click-instruction">Tengo algo para ti...</p>
    </div>

    <div id="main-content-container">
        <div class="San_Valentin">
            <div class="content-wrapper">
                <div class="text-section">
                    <span class="title">Para el amor de mi vida:</span>
                    <p>Si pudiera elegir un lugar seguro, sería a tu lado.</p>
                    <p>Cuanto más tiempo estoy contigo más te amo.</p>
                    <div class="signature">— I Love You! _</div>
                </div>

                <div class="image-section">
                    <canvas id="heart-tree-canvas" width="300" height="280"></canvas>
                </div>
            </div>

            <div class="timer-section">
                <span class="timer-title">Mi amor por ti comenzó hace...</span>
                <div class="timer-display" id="contador"></div>
            </div>

        </div>
    </div>

    <script>
        // Abrir carta
        document.getElementById('heart-button').addEventListener('click', () => {
            document.body.classList.add('open-letter');
        });

        // Contador → MODIFICADO AQUÍ
        const fechaInicio = new Date(2025, 0, 7, 17, 43, 0).getTime();

        function actualizarContador() {
            const diff = Date.now() - fechaInicio;
            const d = Math.floor(diff / 86400000);
            const h = Math.floor((diff % 86400000) / 3600000);
            const m = Math.floor((diff % 3600000) / 60000);
            const s = Math.floor((diff % 60000) / 1000);
            document.getElementById("contador").innerHTML = `
                <div class="time-unit">${d} <span class="time-label">días</span></div>
                <div class="time-unit">${h} <span class="time-label">horas</span></div>
                <div class="time-unit">${m} <span class="time-label">minutos</span></div>
                <div class="time-unit">${s} <span class="time-label">seg.</span></div>
            `;
        }
        setInterval(actualizarContador, 1000);
        actualizarContador();

        // Árbol de corazones (sin cambios)
        const canvas = document.getElementById('heart-tree-canvas');
        const ctx = canvas.getContext('2d');
        let foliage = [], floaters = [];

        function drawHeart(x, y, size, color, rot = 0) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(rot * Math.PI / 180);
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(-size*0.5, -size*0.3, size*0.5, Math.PI, 0, false);
            ctx.arc(size*0.5, -size*0.3, size*0.5, Math.PI, 0, false);
            ctx.lineTo(0, size*0.75);
            ctx.fill();
            ctx.restore();
        }

        function initTree() {
            foliage = [];
            const cx = 150, cy = 115, scale = 4.2;
            const colors = ['#e63939','#f25c54','#ff6b6b','#ff8e8e','#ff477e','#db3a6e','#f15bb5'];
            for (let i = 0; i < 180; i++) {
                const t = Math.random() * Math.PI * 2;
                const r = Math.sqrt(Math.random());
                const bx = 16 * Math.pow(Math.sin(t), 3);
                const by = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
                const x = cx + bx * scale * r;
                const y = cy - by * scale * r;
                const size = 7 + Math.random() * 10;
                const color = colors[Math.floor(Math.random() * colors.length)];
                foliage.push({x, y, size, color, phase: Math.random()*Math.PI*2, rot: (Math.random()-0.5)*12});
            }
            floaters = [];
            for (let i = 0; i < 18; i++) {
                floaters.push({x:40+Math.random()*90, y:Math.random()*280, size:9+Math.random()*7, color:'#ff69b4', speed:0.7+Math.random()*1.3, phase:Math.random()*Math.PI*2, alpha:0.5+Math.random()*0.5});
            }
        }

        let lastTime = 0;
        function animate(ts) {
            if (!lastTime) lastTime = ts;
            const dt = ts - lastTime; lastTime = ts;
            ctx.clearRect(0,0,300,280);

            ctx.fillStyle = '#5d4037'; ctx.fillRect(132,195,36,85);
            ctx.fillStyle = '#6d4c41'; ctx.fillRect(140,195,12,85);

            const time = ts / 280;
            foliage.forEach(h => {
                const oy = Math.sin(time + h.phase) * 2.5;
                const ox = Math.cos(time*1.3 + h.phase) * 1.2;
                drawHeart(h.x + ox, h.y + oy, h.size, h.color, h.rot);
            });

            floaters.forEach(f => {
                f.y += f.speed * (dt/16);
                f.x += Math.sin(time + f.phase) * 1.4;
                if (f.y > 310) { f.y = -20; f.x = 30 + Math.random()*100; }
                ctx.globalAlpha = f.alpha;
                drawHeart(f.x, f.y, f.size, f.color, Math.sin(time + f.phase)*8);
            });
            ctx.globalAlpha = 1;
            requestAnimationFrame(animate);
        }
        initTree();
        requestAnimationFrame(animate);
    </script>
</body>
</html>